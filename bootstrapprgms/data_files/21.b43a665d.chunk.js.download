(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{"3y+j":function(e,t,n){},"6wvX":function(e,t,n){"use strict";var a=n("uDfI"),c=n("0lfv");t.a=function useIsMobile(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Object(a.c)(function(t){return Object(c.i)(t.session.context.userAgent,e)})}},"7fJ7":function(e,t,n){"use strict";n.r(t);var a=n("mj2O"),c=n.n(a),r=n("7SM1"),o=n("s8DI"),s=n("QtlZ"),i=n("Wjfv"),u=n("7oto"),l=function UseRemoveActiveCampaign(){Object(u.c)({topic:"CONDUCTOR:remove-active-campaign",handler:function handler(e){s.a.dispatch(Object(i.a)())}})},d=n("nfbA"),b=n("mfas"),f=function UseStateSnapShot(){return Object(u.c)({topic:"CONDUCTOR:request-state-from-controller",handler:function handler(e){var t=e.data,n=s.a.getState();Object(u.a)({topic:"".concat(t.name,":state-snap-shot"),message:{state:Object(d.a)(Object(d.a)({},Object(b.a)(["session"],n)),{},{session:Object(b.a)(["sockets"],n.session)})}})}}),s.a},p=n("My8U"),h=n("nJ3u"),O=n("O94r"),v=n.n(O),g=n("nQD+"),j=n("ab+K"),m=n("7oh4"),_=n("nedb"),k=n("LVcX"),w=n("ERkP"),E=n.n(w),C=function useIsBotMessage(e){return Object(w.useMemo)(function(){return Object(k.a)(!1,["attributes","isBot"],e)},[e])},y=n("z24s"),I=n("rAhV"),S=n("58kB"),x=n("LaGA"),A=function useResizeObserver(){var e=Object(w.useState)(),t=Object(o.a)(e,2),n=t[0],a=t[1],c=Object(w.useState)(null),r=Object(o.a)(c,2),s=r[0],i=r[1],u=Object(w.useRef)(null),l=Object(w.useCallback)(function(){return u.current&&u.current.disconnect()},[]),d=Object(w.useCallback)(function(){s&&(u.current=new x.a(function(){return a(function getRectForRef(e){return e&&e.getBoundingClientRect()}(s))}),u.current.observe(s))},[s]);return Object(w.useLayoutEffect)(function(){return d(),function(){return l()}},[l,d]),[n,i]},R=n("lE29"),M=n("da4L"),T=n("i9gz"),P=n("DboL"),N=n("uDfI"),U=function useUnreadMessagesForActiveConversation(){var e=Object(N.c)(function(e){return e.conversations}).activeConversation,t=Object(N.c)(function(t){return Object(k.a)({},["conversations","messages",e],t)}),n=Object(N.c)(function(t){return Object(k.a)([],["conversations","unreadAgentMessages",e],t)});return Object(w.useMemo)(function(){if(Object(T.a)(t))return[];var e=Object(M.l)(Object(P.a)(t));return e.filter(function(e){return function messageHasBody(e){return!!e.body&&!!e.body.length}(e)&&function messageIsNotRatingPrompt(e){return!Object(M.e)(e,"ratingPrompt")}(e)&&function messageIsUnread(e){return n.includes(e.id)}(e)})},[t,n])},D=n("LwEI"),L=n("SsZN"),B=n("vjCh"),V=n("X9/c"),F=n("g6eD"),$=n("RhEL"),W=n("oPI6"),H=n("vTYT"),J=n("y0on"),q=(n("pUpc"),function MessagePreview(){var e=A(),t=Object(o.a)(e,2),n=t[0],a=t[1],c=Object(N.b)(),r=Object(w.useState)(null),s=Object(o.a)(r,2),u=s[0],l=s[1],d=Object(w.useRef)(null),b=Object(y.a)(d),f=Object(N.c)(function(e){return e.conversations}).activeConversation,p=U(),O=Object(_.a)(),x=Object(R.a)(),P=Object(N.c)(function(e){return e.view.chatOpen}),q=Object(D.a)(),z=Object(S.a)(u?u.authorId:null),G=Object(w.useMemo)(function(){return!(!u||!u.body||P)},[u,P]),Y=Object(I.a)().markAsRead;Object(w.useEffect)(function setLatestMessageFromConvo(){if(Object(T.a)(p))l(null);else{var e=p.pop()||{};u&&Object($.a)(e.id,u.id)||l(Object(M.o)(e,100))}},[p]),Object(w.useLayoutEffect)(function updateFrameSize(){if(G){var e=n?n.width:0,t=n?n.height:0,a=e+m.b+40,c=t+36;Object(V.c)(c,a)}},[n,G]);var Q=C(u);if(!G)return null;var X=function dismiss(){if(u&&(Y(f),l({}),Object(V.b)(),Q)){var e=Object(k.a)(null,["attributes","playbookId"],O);Object(L.p)(u),Object(B.g)(O.id,e),c(Object(i.a)())}},K=Object(M.c)(u),Z=Object(J.a)(z.recipient.name,K);return E.a.createElement(E.a.Fragment,null,E.a.createElement("style",null,"\n          .drift-widget-message-preview .drift-widget-message-preview-text p.keyboard-focused {\n            ".concat(Object(h.c)(x.activeColor),"\n          }\n        ")),E.a.createElement("div",{className:"drift-widget-message-preview-wrapper",key:"".concat(u.id,"-preview-box")},E.a.createElement(W.b,{message:Z,"aria-live":"polite",clearOnUnmount:!0}),E.a.createElement("div",{className:"drift-widget-message-preview drift-widget-message-preview--align-".concat(q)},q===H.a.RIGHT&&E.a.createElement(j.a,{onClick:X}),E.a.createElement(g.a,{ref:d,onClick:function openChat(){if(Object(V.b)(),Y(f),Q){var e=Object(k.a)(null,["attributes","playbookId"],O);Object(L.o)(u),Object(B.g)(O.id,e)}c(Object(F.a)({chatOpen:!0}))},className:"drift-widget-message-preview-text drift-widget-message-preview-text--align-".concat(q),"aria-label":"".concat(Z?Z+" - ":"","Click to open chat")},E.a.createElement("p",{ref:a,className:v()({"keyboard-focused":b})},K)),q===H.a.LEFT&&E.a.createElement(j.a,{onClick:X}))))}),z=n("+Kbs"),G=n("yEsl"),Y=n("hSLT"),Q=n("6wvX"),X=n("tLIi"),K=n("o3t1"),Z=function useThemeIcon(){var e=Object(N.c)(function(e){return e.embed.configuration}).theme,t=e.iconStyle,n=e.iconUrl,a=e.foregroundColor,c={SOLID1:E.a.createElement(z.h,{fill:"#".concat(a)}),SOLID2:E.a.createElement(z.g,{fill:"#".concat(a)}),OUTLINE1:E.a.createElement(z.e,{fill:"#".concat(a)}),OUTLINE2:E.a.createElement(z.f,{fill:"#".concat(a)}),BOLT:z.c};return{customIcon:n?{backgroundImage:"url(".concat(n,")"),backgroundSize:"cover",backgroundRepeat:"no-repeat"}:{},hasCustomIcon:!!n,Icon:c[t]||null}},ee=n("8saY"),te=function useWidgetIconShape(){return Object(N.c)(function(e){return e.embed.configuration.theme.widgetIconShape})||ee.b.SQUARE},ne=function shouldWidgetIconDisplay(e){var t,n,a=e.view,c=void 0===a?{}:a,r=e.conversations,o=void 0===r?{}:r,s=e.embed,i=void 0===s?{}:s,u=e.campaigns,l=void 0===u?{}:u,d=c.matchedTargeting,b=o.hasForcedConversation,f=!!(null===l||void 0===l?void 0:null===(t=l.activeCampaign)||void 0===t?void 0:t.id),p=!Object(T.a)(o.conversations);return!(!(null===i||void 0===i?void 0:null===(n=i.configuration)||void 0===n?void 0:n.gates.show_chat_existing_conversations)||!p)||(d||b||f)},ae=n("0B8E"),ce=n("MFhO"),re=function(){var e=Object(r.a)(c.a.mark(function _callee(){var e,t;return c.a.wrap(function _callee$(n){for(;;)switch(n.prev=n.next){case 0:if(e=Object(k.a)(!1,["embed","configuration","theme","soundNotificationEnabled"],s.a.getState()),t=s.a.getState().view.chatOpen,!e){n.next=5;break}return n.next=5,Object(u.a)({topic:"play-host-notification",message:{chatOpen:t}});case 5:case"end":return n.stop()}},_callee)}));return function playSoundNotification(){return e.apply(this,arguments)}}(),oe=n("rTkt"),se=(n("3y+j"),function WidgetIcon(){var e=Object(w.useRef)(null),t=Object(y.a)(e),n=Object(K.a)(),a=n.hoverProps,c=n.isHovered,r=Object(N.b)(),o=Object(N.c)(function(e){return e.view.chatOpen}),s=Object(N.c)(function(e){return e.session.gdpr}),i=Object(N.c)(ne),l=Object(N.c)(function(e){return!!e.conversations.activeConversation}),b=Object(D.a)(),f=Object(_.a)(),p=Object(N.c)(function(e){return Object(k.a)(!1,["embed","configuration","theme"],e)}).unreadBadgeEnabled,O=Object(N.c)(function(e){return e.conversations}).activeConversation,g=U(),j=Object(X.a)(),m=C(j),S=Object(R.a)(),x=S.activeColor,A=S.backgroundStyles,M=S.widgetSecondaryColor,T=Object(w.useMemo)(function(){return c?Object(oe.c)(A.background,-35):A.background},[c,A]),P=Z(),$=P.Icon,W=P.customIcon,H=P.hasCustomIcon,J=Object(Y.a)(),q=J.senderId,ee=J.type,se=Object(I.a)().markAsRead,ie=q||Object(k.a)(void 0,["authorId"],j),ue=g?Object(ae.a)(g).length:0,le=ee===ce.a.SLIDER,de=le&&q,be=ie&&g.length>0,fe=Object(Q.a)(),pe=te();Object(w.useEffect)(function(){i&&Object(V.d)()},[i]),Object(w.useEffect)(function(){Object(u.a)({topic:"toggle-widget-controller",message:{open:o,hasActiveConversation:l&&s.hasConsent}})},[o,s,l]),Object(w.useEffect)(function(){g&&g.length>0&&re()},[g]);var he=Object(w.useMemo)(function(){return be&&!o?null:{background:"".concat(T)}},[be,o,T]),Oe=Object(w.useMemo)(function(){return!H||be||o?null:c?Object(d.a)({opacity:.65},W):W},[W,be,o,H,c]),ve=Object(w.useMemo)(function(){return o?"Close chat":p&&ue>0?"".concat("Open chat"," - Unread messages: ").concat(ue):"Open chat"},[o,p,ue]);return E.a.createElement(E.a.Fragment,null,E.a.createElement("style",null,"\n          .drift-widget-controller.keyboard-focused:before {\n            ".concat(Object(h.a)(x,64),"\n          }\n        ")),E.a.createElement("button",Object.assign({className:v()("drift-widget-controller drift-widget-controller--align-".concat(b),[pe],{"drift-widget-controller--closed":!fe&&o,"drift-widget-controller--custom-icon":H,"drift-widget-controller--avatar":be,"keyboard-focused":t}),onClick:function onToggleChat(){if(!o&&(se(O),ue>0&&m)){var e=Object(k.a)(null,["attributes","playbookId"],f);Object(B.g)(f.id,e),Object(L.o)(j)}!function toggle(e){le?Object(u.a)({topic:"slider:showDetails",message:{}}):r(Object(F.a)({chatOpen:e})),e&&Object(u.a)({topic:"reset-controller-size"})}(!o)},style:he},a,{"aria-label":ve,ref:e}),E.a.createElement("div",{className:v()("drift-widget-controller-icon",[pe]),style:Oe},E.a.createElement("div",{className:"drift-controller-icon--active"},!H&&!be&&(de?E.a.createElement(z.l,{fill:M}):$),be&&E.a.createElement(G.a,{className:v()([pe],"drift-controller-icon--avatar"),avatarClassName:v()([pe],"drift-controller-icon--avatar-avatar"),id:ie})),E.a.createElement("div",{className:"drift-controller-icon--close",style:{backgroundColor:M}})),p&&ue>0&&E.a.createElement("div",{className:"drift-controller-icon-unread"},Math.min(ue,99))))}),ie=n("Sn8X"),ue=function ControllerLayout(){return Object(ie.a)(),E.a.createElement("main",{role:"main","aria-label":"Chat widget"},E.a.createElement(W.a,null,E.a.createElement(q,null),E.a.createElement(se,null)))},le=n("WwEg"),de=n("OE2q"),be=n("LqZ+"),fe=n("K7i0"),pe=n("Cpup"),he=function receiveEmbedConfiguration(e){return Object(pe.a)({type:"RECEIVE_EMBED_CONFIGURATION",payload:e})},Oe=n("SFoa"),ve=n("PCkZ"),ge=n("TDUE"),je=n("qwiD"),me=n("ws1h"),_e=n("FAmh"),ke=n("pqMu"),we=n("LelF"),Ee=n("gG69"),Ce=n("0lfv"),ye=function hasGate(e){return Object(k.a)(!1,["embed","configuration","gates",e],s.a.getState())},Ie=n("Nlet"),Se=n("VYE+"),xe=n("uIJS"),Ae=n("wQh9"),Re=function(){function SyncCallbackRunner(){Object(xe.a)(this,SyncCallbackRunner),this._running=!1,this._callbacks=[]}return Object(Ae.a)(SyncCallbackRunner,[{key:"execute",value:function execute(e){this._callbacks.push(e),this.run()}},{key:"run",value:function(){var e=Object(r.a)(c.a.mark(function _callee(){var e,t;return c.a.wrap(function _callee$(n){for(;;)switch(n.prev=n.next){case 0:if(!this._running&&0!==this._callbacks.length){n.next=2;break}return n.abrupt("return");case 2:this._running=!0;case 3:if(!(this._callbacks.length>0)){n.next=11;break}if(e=this._callbacks.shift(),!(t=e())||!t.then){n.next=9;break}return n.next=9,t;case 9:n.next=3;break;case 11:this._running=!1;case 12:case"end":return n.stop()}},_callee,this)}));return function run(){return e.apply(this,arguments)}}()}]),SyncCallbackRunner}(),Me=n("4c+F"),Te=n("hm8b"),Pe=n("3kqR"),Ne=Object.freeze({welcomeMessage:"welcomeMessage",awayMessage:"awayMessage",emailCaptureMessage:"emailCaptureMessage",thankYouMessage:"confirmationMessage"}),Ue=function apiWarning(){for(var e,t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=console).warn.apply(e,["Drift API -"].concat(n))},De=function apiError(){for(var e,t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return(e=console).error.apply(e,["Drift API -"].concat(n))},Le=n("F8vJ"),Be=function areAttributesValid(e,t,n,a){if(Object(Te.a)(a))return n;if("function"!==typeof a&&Object(ke.a)(Object,a)){for(var c=0,r=Object.keys(a);c<r.length;c++){var o=r[c],s=a[o];if(!Object(ke.a)(Number,s)&&!Object(ke.a)(String,s)&&!Object(ke.a)(Boolean,s))return De("".concat(e,'(...) "').concat(o,'" in ').concat(t," must be number, string, or boolean but instead we got ").concat(typeof s,".")),!1;if("email"===o&&(!Object(ke.a)(String,s)||!Object(Le.a)(s)))return De("".concat(e,"(...) email in ").concat(t," is invalid:"),s),!1}return!0}return!1},Ve=function param(e,t,n){return{name:e,type:t,optional:n}},Fe={config:[Ve("options",Object)],collectFormData:[Ve("data",Be),Ve("options",Object,!0)],goToConversation:[Ve("Conversation ID",Number)],goToNewConversation:[Ve("Message",String)],identify:[Ve("User ID",String),Ve("attributes",Be,!0),Ve("options",Object,!0)],off:[Ve("Event name",String),Ve("handler",Function)],on:[Ve("Event name",String),Ve("handler",Function)],page:[Ve("Page name",String,!0)],setUserAttributes:[Ve("attributes",Be)],setUserJwt:[Ve("User JWT",String)],scheduleMeeting:[Ve("Agent ID",Number),Ve("options",Object,!0)],showAwayMessage:[Ve("Message",String,!0)],showWelcomeMessage:[Ve("Message",String,!0)],startInteraction:[Ve("params",function areStartInteractionParamsValid(e,t,n,a){return Object(Te.a)(a)&&!n||!Object(ke.a)(Object,a)?(De("".concat(e,"({ ... }) must be called with ").concat(t," { interactionId: number, goToConversation: boolean } (goToConversation is optional.)")),!1):a.interactionId&&!Object(Te.a)(a.interactionId)&&Object(ke.a)(Number,a.interactionId)?!(a.goToConversation&&!Object(ke.a)(Boolean,a.goToConversation))||(De("".concat(e,'({ ... }) "goToConversation" parameter should be boolean but we got ').concat(typeof a.goToConversation,".")),!1):(De("".concat(e,"({ ... }) requires ").concat(t,' object with numeric "interactionId" but we got ').concat(typeof a.interactionId,".")),!1)})],toggleHoursAndTargeting:[Ve("enabled",Boolean)],track:[Ve("Event name",String),Ve("attributes",Be,!0)]},$e=function getTypeName(e){return e===String||Object(ke.a)(String,e)?"string":e===Boolean||Object(ke.a)(Boolean,e)?"boolean":e===Number||Object(ke.a)(Number,e)?"number":e===Object||Object(ke.a)(Object,e)?"object":e===Function||Object(ke.a)(Function,e)?"function":Object(Te.a)(e)?"null":"unknown"},We=function validateMethod(e,t){return Fe[e]?function areArgsValid(e,t,n){var a=t.length,c=n.filter(function(e){return!e.optional}).length;return n.reduce(function(n,r,o){var s=r.name,i=r.type,u=r.optional,l=void 0!==u&&u;if(o>=a)return l||De("Invalid ".concat(e,"(...) call! It requires ").concat(c," argument(s) and it's missing ").concat(s," ").concat($e(i),".")),n&&l&&a>=c;var d=t[o],b=!1;return l&&Object(Te.a)(d)?b=!0:i===Function||i===Object||i===String||i===Number||i===Boolean?(b="function"===typeof d?i===Function:Object(ke.a)(i,d))||De("Invalid ".concat(e,"(...) call! ").concat(s," (arg ").concat(o,") should be ").concat($e(i)," instead of ").concat($e(d),".")):b=i(e,s,l,d),n&&b},!0)}(e,t,Fe[e]):(!Object(Te.a)(t)&&Object(ke.a)(Array,t)&&!!t.length&&Ue("".concat(e,"() should ideally be called without arguments.")),!0)},He=function track(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{Object(be.a)(e,t)}catch(n){Object(Ce.k)({data:[n],type:"warn"})}},Je=function(){var e=Object(r.a)(c.a.mark(function _callee(){return c.a.wrap(function _callee$(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Se.b)(we.c);case 2:Object(u.a)({topic:"reload-all-frames",message:{}});case 3:case"end":return e.stop()}},_callee)}));return function reset(){return e.apply(this,arguments)}}(),qe=function openChat(){Xe(),s.a.dispatch(Object(F.a)({chatOpen:!0}))},ze=function hideChat(){s.a.dispatch(Object(F.a)({chatOpen:!1}))},Ge=function(){var e=Object(r.a)(c.a.mark(function _callee2(e){var t,n,a,r;return c.a.wrap(function _callee2$(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,Object(Ie.b)();case 2:return t=c.sent,s.a.dispatch(Object(je.h)(t)),n=Object(d.a)({},Object(k.a)({},["page"],t)),e&&"string"===typeof e&&(n.pageName=e),He("Page",n),c.next=9,Object(u.a)({topic:"reset-campaign-refresh-token"});case 9:a=c.sent,r=a.data,s.a.dispatch(Object(je.t)(Object(Ce.o)())),s.a.dispatch(Object(je.s)(r)),Object(_e.a)();case 14:case"end":return c.stop()}},_callee2)}));return function page(t){return e.apply(this,arguments)}}(),Ye=function debouncedAPIMethod(e){return Object(Ce.c)(e,500,!0)}(function(){var e=Object(r.a)(c.a.mark(function _callee3(e){var t,n;return c.a.wrap(function _callee3$(a){for(;;)switch(a.prev=a.next){case 0:if(t=(e||{}).interactionId,n=Object(Oe.d)(),t||Object(ke.a)(Number,t)){a.next=4;break}return a.abrupt("return");case 4:return s.a.dispatch(Object(fe.p)()),a.next=7,Object(de.a)(t,{isTriggeredFromAPI:!0,locale:n});case 7:case"end":return a.stop()}},_callee3)}));return function _startInteraction(t){return e.apply(this,arguments)}}()),Qe=function(){var e=Object(r.a)(c.a.mark(function _callee4(){var e,t,n,a,r,o,i=arguments;return c.a.wrap(function _callee4$(c){for(;;)switch(c.prev=c.next){case 0:return e=i.length>0&&void 0!==i[0]?i[0]:"",t=Object(Oe.d)(),c.prev=2,c.next=5,Object(de.b)(e,{isTriggeredFromAPI:!0,locale:t});case 5:return n=c.sent,a=n.data,c.next=9,Object(de.f)(a.conversationId);case 9:r=c.sent,o=r.data,s.a.dispatch(Object(fe.g)({conversation:o})),s.a.dispatch(Object(fe.n)({conversationId:a.conversationId})),c.next=17;break;case 15:c.prev=15,c.t0=c.catch(2);case 17:case"end":return c.stop()}},_callee4,null,[[2,15]])}));return function goToNewConversation(){return e.apply(this,arguments)}}(),Xe=function show(){s.a.dispatch(Object(F.d)({matchedTargeting:!0})),Object(V.d)()},Ke=function(){var e=Object(r.a)(c.a.mark(function _callee5(e,t){var n,a,r,o;return c.a.wrap(function _callee5$(c){for(;;)switch(c.prev=c.next){case 0:return n=Object(k.a)(null,["session","endUser","email"],s.a.getState()),a=Object(Oe.d)(),qe(),c.prev=3,c.next=6,Object(de.c)(n,e,a,t);case 6:r=c.sent,o=r.data.conversationId,s.a.dispatch(Object(fe.n)({conversationId:o})),Object(L.j)(e),Object(ge.d)(Ee.c.CALENDAR_DROP),c.next=16;break;case 13:c.prev=13,c.t0=c.catch(3),Object(Ce.k)({data:[c.t0],type:"warn"});case 16:case"end":return c.stop()}},_callee5,null,[[3,13]])}));return function scheduleMeeting(t,n){return e.apply(this,arguments)}}(),Ze=function(){var e=Object(r.a)(c.a.mark(function _callee6(e){var t,n,a,r,o=arguments;return c.a.wrap(function _callee6$(c){for(;;)switch(c.prev=c.next){case 0:return t=o.length>1&&void 0!==o[1]?o[1]:{},n=o.length>2&&void 0!==o[2]?o[2]:{},c.prev=2,a=Object(b.a)(["hasProvidedIdentity"],t),c.next=6,Object(ve.c)(a,e,n);case 6:t.email&&(r=t.email,s.a.dispatch(Object(je.j)({endUser:{email:r}}))),c.next=12;break;case 9:c.prev=9,c.t0=c.catch(2),Object(Ce.k)({data:[c.t0],type:"warn"});case 12:case"end":return c.stop()}},_callee6,null,[[2,9]])}));return function identify(t){return e.apply(this,arguments)}}(),et=function(){var e=Object(r.a)(c.a.mark(function _callee7(e){return c.a.wrap(function _callee7$(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(ve.c)(e);case 2:Object(L.s)();case 3:case"end":return t.stop()}},_callee7)}));return function setUserAttributes(t){return e.apply(this,arguments)}}(),tt=function(){var e=Object(r.a)(c.a.mark(function _callee8(e,t){return c.a.wrap(function _callee8$(n){for(;;)switch(n.prev=n.next){case 0:if(ye("has_widget_forms")){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,Object(ve.c)(e);case 4:if(Object(L.i)(e),t){n.next=7;break}return n.abrupt("return");case 7:if(!t.redirectTo){n.next=10;break}return n.next=10,Object(u.a)({topic:"redirect-to-url",message:{url:t.redirectTo}});case 10:case"end":return n.stop()}},_callee8)}));return function collectFormData(t,n){return e.apply(this,arguments)}}(),nt=function(){var e=Object(r.a)(c.a.mark(function _callee9(){return c.a.wrap(function _callee9$(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(me.a)();case 2:return e.t0=e.sent,e.next=5,Object(me.b)();case 5:return e.t1=e.sent,e.abrupt("return",{isOnline:e.t0,teamAvailability:e.t1,sidebarOpen:!1});case 7:case"end":return e.stop()}},_callee9)}));return function getWidgetReadyPayload(){return e.apply(this,arguments)}}(),at={identify:Ze,config:function config(e){if(!Object(ke.a)(Object,e))return!1;var t=e.cookieDomain;if(t){var n=Object(Se.f)([t]);n&&s.a.dispatch(Object(je.i)({cookieDomain:n}))}var a=function configOptionsToEmbedConfiguration(e){var t={theme:{}};if(Object(Te.a)(e))return t;var n=e.locale,a=e.enableWelcomeMessage,c=e.enableCampaigns,r=e.enableChatTargeting,o=e.backgroundColor,s=e.foregroundColor,i=e.activeColor,u=e.textColor,l=e.widgetBackgroundColor,d=e.autoAssigneeId,b=e.autoAssignee,f=e.inboxId,p=e.enabled,h=e.profileMode,O=e.messages,v=e.cookieDomain,g=e.verticalOffset;return n&&(t.locale=n),Object(Te.a)(a)||(t.theme.showWelcomeMessage=!!a),Object(Te.a)(c)||(t.campaignsEnabled=c),!1===r&&(t.theme.audience=ee.a.EVERYONE,t.theme.conditions=[]),o&&(t.theme.backgroundColor=o.replace("#","")),s&&(t.theme.foregroundColor=s.replace("#","")),i&&(t.theme.activeColor=i.replace("#","")),u&&(t.theme.textColor=u.replace("#","")),l&&(t.theme.widgetBackgroundColor=l.replace("#","")),Object(Te.a)(d)||(t.autoAssigneeId=d),Object(Te.a)(b)||(t.autoAssignee=b),f&&(t.inboxId=f),Object(Te.a)(g)||(t.verticalOffset=g),Object(Te.a)(p)||(t.enabled=!!p),Object(Te.a)(h)||(t.profileMode=!!h),Object(Te.a)(O)||Object(Pe.a)(function(e,n){O[n]&&(t.theme[e]=O[n])},Ne),Object(Te.a)(v)||(t.theme.cookieDomains=[v]),t}(e);s.a.dispatch(function receiveEmbedConfigurationOverride(e){return Object(pe.a)({type:"RECEIVE_EMBED_CONFIGURATION_OVERRIDE",payload:e})}(a))},track:He,reset:Je,debug:function debug(){Ue("drift.debug is not supported in this release.")},show:Xe,ping:function ping(){Ue("drift.ping is not supported in this release.")},page:Ge,hide:function hide(){ze(),Object(V.a)()},off:function off(){},on:function on(){},collectFormData:tt,goToConversation:function goToConversation(e){s.a.dispatch(Object(fe.n)({conversationId:e})),qe()},goToConversationList:function goToConversationList(){var e=s.a.getState().conversations;Object(T.a)(e.conversations)||(qe(),s.a.dispatch(Object(F.b)({conversationHistoryOpen:!0})))},goToNewConversation:Qe,hideAwayMessage:function hideAwayMessage(){return ze()},hideChat:ze,hideWelcomeMessage:function hideWelcomeMessage(){return ze()},openChat:qe,toggleChat:function toggleChat(){Object(k.a)(!1,["view","chatOpen"],s.a.getState())?ze():qe()},scheduleMeeting:Ke,setUserAttributes:et,showAwayMessage:function showAwayMessage(e){s.a.dispatch(Object(fe.a)()),s.a.dispatch(Object(i.a)()),s.a.dispatch(Object(F.d)({matchedHours:!1,matchedTargeting:!0})),e&&"string"===typeof e&&e.length&&s.a.dispatch(function receiveEmbedAwayMessage(e){return Object(pe.a)({type:"RECIEVE_EMBED_AWAY_MESSAGE",payload:e})}({message:e})),Object(V.d)(),s.a.dispatch(Object(F.a)({chatOpen:!0}))},showWelcomeMessage:function showWelcomeMessage(e){s.a.dispatch(Object(fe.a)()),s.a.dispatch(Object(i.a)()),s.a.dispatch(Object(F.d)({matchedHours:!0,matchedTargeting:!0})),e&&"string"===typeof e&&e.length&&s.a.dispatch(function receiveEmbedWelcomeMessage(e){return Object(pe.a)({type:"RECEIVE_EMBED_WELCOME_MESSAGE",payload:e})}({message:e})),Object(V.d)(),s.a.dispatch(Object(F.a)({chatOpen:!0}))},showWelcomeOrAwayMessage:function showWelcomeOrAwayMessage(){s.a.dispatch(Object(fe.a)()),qe()},startInteraction:Ye,startVideoGreeting:function startVideoGreeting(){Ue("drift.startVideoGreeting is not supported in this release.")},evaluateCampaignTargeting:function evaluateCampaignTargeting(){Object(_e.a)()},toggleHoursAndTargeting:function toggleHoursAndTargeting(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];s.a.dispatch(Object(F.d)({matchedHours:e,matchedTargeting:!0}))},waitForUserJwt:function waitForUserJwt(){try{s.a.dispatch(Object(je.u)())}catch(e){Object(Ce.k)({data:[e],type:"warn"})}},setUserJwt:function setUserJwt(e){try{s.a.dispatch(Object(je.m)(e))}catch(t){Object(Ce.k)({data:[t],type:"warn"})}}},ct=new Re,rt=function handleApiEvent(e){var t=e.data,n=t.method,a=t.args;at[n]?We(n,a)&&ct.execute(function(){return Object(Me.c)("API Event Fired",{method:n}),at[n].apply(at,Object(le.a)(a))}):De("".concat(n,"(...) does not exist."))},ot=n("efbE"),st=n("LeJ0"),it=n("l+Xe"),ut=function setUserApiBase(){var e="LOCAL"===st.a.WS_USER_ENV?"http":"https";ot.s.defaults.baseURL="".concat(e,"://").concat(st.a.WS_USER_BASE,"/api")},lt=function setVisitorPresenceApiBase(){var e="LOCAL"===st.a.WS_USER_ENV?"http":"https";ot.t.defaults.baseURL="".concat(e,"://").concat(st.a.WS_VISITOR_PRESENCE_BASE,"/api")},dt=function setChatApiBase(e){var t="LOCAL"===st.a.WS_USER_ENV?"http":"https";ot.c.defaults.baseURL="".concat(t,"://").concat(Object(it.d)(e),"/api")},bt=function getAuthForChatSocket(e){return ot.c.post("auth",e)},ft=function getAuthForUserSocket(e){return ot.s.post("auth",e)},pt=function getAuthForVisitorPresenceSocket(e){return ot.t.post("auth",e)},ht=function widgetBootstrap(e,t){var n=function getDefaultAuthParams(e){return{org_id:e,client_id:st.a.CLIENT_ID,consent_id:"has_consent"}}(e);return ot.b.post("widget_bootstrap",{data:Object(d.a)(Object(d.a)({},n),t)})},Ot=function getEmbedConfiguration(e){return ot.m.get("/embeds/".concat(e,".json"))},vt=n("vEWT"),gt=["BE","BG","CZ","DK","DE","EE","IE","EL","ES","FR","HR","IT","CY","LV","LT","LU","HU","MT","NL","AT","PL","PT","RO","SI","SK","FI","SE","GB"],jt=["CA"],mt={EU:gt,CANADA:jt,EU_CANADA:[].concat(jt,gt),NONE:"NONE",ALL:"ALL"},_t={googleAnalyticsSettings:!0},kt=n("yKvL"),wt=n("6BAR"),Et=n("qixE"),Ct=n("CYoe"),yt=n("z8Kx"),It=n("LvsC"),St=n("qytN"),xt=n("7jL2"),At=n("t8ds"),Rt=At.a.get,Mt=function(){var e=Object(r.a)(c.a.mark(function _callee(){var e,t,n,a,r,o;return c.a.wrap(function _callee$(c){for(;;)switch(c.prev=c.next){case 0:return e=s.a.getState(),t=e.session,n=e.conversations,c.next=3,Rt("visitCounts");case 3:return a=c.sent,r=a.data,o=Object(b.a)(["href"],t.context.page),c.abrupt("return",{engagement:{activeConversation:n.endUserEngaged},page:o,location:Pt(t.geo),session:Tt(t.context,r)});case 7:case"end":return c.stop()}},_callee)}));return function generatePresenceContext(){return e.apply(this,arguments)}}(),Tt=function _hydrateSessionPresenceData(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{numPageViews:Object(k.a)(0,["total"],t),numSessions:Object(k.a)(0,["total"],t),currentSessionStartedAt:e.currentSessionStartedAt,currentPageViewStartedAt:e.currentPageViewStartedAt,previousSessionStartedAt:Object(k.a)(null,["lastVisit"],t),previousSessionEndedAt:null,firstSessionAt:Object(k.a)(null,["firstVisit"],t),activeSessionStartedAt:e.activeSessionStartedAt}},Pt=function _hydrateGeoPresenceData(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(Te.a)(e)?{}:{ip:e.ip,city:e.city,subdivision:e.subdivision,country:e.country,countryCode:e.countryCode,gdprApplicable:e.gdprApplicable,metroCode:e.metroCode,postalCode:e.postalCode,latLong:{lat:e.latitude,lon:e.longitude}}},Nt=n("7VeV"),Ut=n("Gzp1"),Dt=function OpenSocket(e){var t=e.session_token,n=e.org_id,a=e.socketCluster,c=e.ip,r=st.a.WS_PROTOCOL,o="LOCAL"===st.a.WS_USER_ENV?"":"".concat(n,"-"),s=Bt(n,o,a),i="".concat(r,"://").concat(s,"/ws"),u=new Ut.Socket(i,{params:{session_token:t,remote_ip:c},timeout:1e4,reconnectAfterMs:function reconnectAfterMs(e){return[1e3,2e3,5e3,1e4][e-1]||1e4},rejoinAfterMs:function rejoinAfterMs(e){return[1e3,2e3,5e3][e-1]||1e4}});return u.connect(),u.onError(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];Object(Ce.k)({data:["Failed to connect to socket: ".concat(i)].concat(t)})}),u.onClose(function(){return Object(Ce.k)({data:["socket ".concat(i," has closed")]})}),u},Lt=function(){var e=Object(r.a)(c.a.mark(function _callee2(e){var t,n,a,o;return c.a.wrap(function _callee2$(s){for(;;)switch(s.prev=s.next){case 0:return t=e.channelName,n=e.socket,a=e.events,o=new Promise(function(){var e=Object(r.a)(c.a.mark(function _callee(e,r){var o;return c.a.wrap(function _callee$(c){for(;;)switch(c.prev=c.next){case 0:o=n.channel(t),a.forEach(function(e){var t=e.topic,n=e.event;o.on(t,n)}),o.join().receive("ok",function(){e({channel:o})}).receive("error",function(e){Object(Ce.k)({data:["Error connecting to channel: ".concat(t)]}),r(e)}).receive("timeout",function(e){Object(Ce.k)({data:["Joining the ".concat(t," channel timed out. ")]})});case 3:case"end":return c.stop()}},_callee)}));return function(t,n){return e.apply(this,arguments)}}()),s.abrupt("return",o);case 3:case"end":return s.stop()}},_callee2)}));return function JoinChannel(t){return e.apply(this,arguments)}}(),Bt=function _resolveSocketBaseForType(e,t,n){switch(n){case ln.CHAT:return"".concat(Object(it.d)(e));case ln.USER:return st.a.WS_USER_BASE;case ln.PRESENCE:return"".concat(t).concat(Object(it.c)(e));case ln.VISITOR_PRESENCE:return st.a.WS_VISITOR_PRESENCE_BASE;default:return""}},Vt="emailCapture",Ft=n("y0Ar"),$t=n("NFvl"),Wt=n("PjZB"),Ht=/(?:(?:\+?1\s*(?:[.-]\s*)?)?(?:\(\s*([2-9]1[02-9]|[2-9][02-8]1|[2-9][02-8][02-9])\s*\)|([2-9]1[02-9]|[2-9][02-8]1|[2-9][02-8][02-9]))\s*(?:[.-]\s*)?)?([2-9]1[02-9]|[2-9][02-9]1|[2-9][02-9]{2})\s*(?:[.-]\s*)?([0-9]{4})(?:\s*(?:#|x\.?|ext\.?|extension)\s*(\d+))?/gim,Jt=n("7BJg");function _createSuper2(e){return function(){var t,n=Object(xt.a)(e);if(function isNativeReflectConstruct(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var a=Object(xt.a)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return Object(St.a)(this,t)}}var qt=1e3,zt=new(function(e){Object(It.a)(AgentMessageEventBuffer,e);var t=_createSuper2(AgentMessageEventBuffer);function AgentMessageEventBuffer(){var e;return Object(xe.a)(this,AgentMessageEventBuffer),(e=t.call(this,qt))._publishBuffer=function(){e._events.length&&(Object(M.l)(e._events).forEach(function(t){e._dispatchAgentMessage(t),Object(M.e)(t,"startInteraction")&&!Object(M.e)(t,"campaignId")?(e._openChatWithMessage(t),e._setMessageReadStatus(t,!0)):e._setMessageReadStatus(t)}),e._resetBuffer())},e._openChatWithMessage=function(e){s.a.getState().view.chatOpen||setTimeout(function(){return s.a.dispatch(Object(F.a)({chatOpen:!0}))},500)},e._setMessageReadStatus=function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]?Object(de.g)(e.conversationId,[e.id]):s.a.dispatch(Object(fe.s)({message:e}))},e._dispatchAgentMessage=function(e){s.a.dispatch(Object(fe.c)({message:e}))},e}return AgentMessageEventBuffer}(Jt.a)),Gt=function evaluateEndUserResponseChatMessage(e){if(Object(M.e)(e,"buttonClicked")&&Object(L.b)(e),e.body){var t=function extractPhoneNumbers(e){return e?e.match(Ht):null}(e.body);t&&t.length&&t.forEach(function(t){Object(L.n)(e,t)})}},Yt=function evaluateBotChatMessage(e){if(Object(M.e)(e,"offerSchedule")||Object(M.e)(e,"presentSchedule")){var t=e.attributes.offerSchedule;Object(L.j)(t),Object(ge.d)(Ee.c.CALENDAR_DROP)}},Qt=n("SHZQ"),Xt=n("IpSJ"),Kt=n("BMKr"),Zt=function(){var e=Object(r.a)(c.a.mark(function _callee(e){var t,n,a;return c.a.wrap(function _callee$(c){for(;;)switch(c.prev=c.next){case 0:return t=Object(k.a)([],["attributes","conditionSetsToEvaluate"],e),c.next=3,Object(Xt.a)(t);case 3:n=c.sent,a={requestingMessageId:e.id,conversationId:e.conversationId,targetingRequestPayload:n};try{Object(Qt.a)(a)}catch(r){Object(Kt.a)(new Error("Failed to evaluate conditional skill"))}case 6:case"end":return c.stop()}},_callee)}));return function evaluateConditionalMessage(t){return e.apply(this,arguments)}}(),en=function evaluateNewMessage(e){var t=Object($t.a)(["body","data"],e);if(Object(M.e)(t,"widgetGuid"))return Gt(t);var n=Object(M.e)(t,"startInteraction"),a=Object(M.e)(t,"liveViewInitiated"),c=Object(M.a)(t,"playbookId"),r=Object(M.a)(t,"interactionId"),o=t.conversationId,i=t.contentType===Wt.c.BOT_NODE_CONDITION_EVALUATION&&Object(M.e)(t,"conditionSetsToEvaluate"),u=Object(k.a)(!1,["contentType",Wt.c.CHAT],t)&&!t.body.length;return n&&(Object(L.q)(t),Object(B.b)(t),Object(Ft.a)({playbookId:c,interactionId:r,conversationId:o,isVirtual:!1})),a?function evaluateLiveViewMessage(e){var t=e.id,n=void 0===t?null:t,a=e.conversationId,c=void 0===a?null:a;if(c&&n){var r=Object(d.a)(Object(d.a)({},e.attributes),{},{senderId:e.authorId}),o=Object(d.a)(Object(d.a)({},e),{},{attributes:r});s.a.dispatch(Object(fe.a)()),s.a.dispatch(Object(fe.n)({conversationId:c})),s.a.dispatch(Object(fe.p)()),s.a.dispatch(Object(fe.c)({message:o}))}}(t):i?Zt(t):Object(M.m)(t)?function evaluateChatMessage(e){var t=e.body.data;if(zt.push(t),Object(L.l)(t),Object(M.e)(t,"isBot"))return Yt(t)}(e):u?Object(de.g)(t.conversationId,[t.id]):void 0},tn={topic:"data:sentMessage",event:function event(e){s.a.dispatch(Object(fe.i)(e))}},nn={topic:"typing:started",event:function event(e){window.fallbackTimeout&&window.clearTimeout(window.fallbackTimeout),s.a.dispatch(Object(fe.q)({conversationId:e.conversationId,userId:e.userId,isTyping:!0})),window.fallbackTimeout=window.setTimeout(function(){s.a.dispatch(Object(fe.q)({conversationId:e.conversationId,userId:e.userId,isTyping:!1}))},5e3)}},an={topic:"typing:finished",event:function event(e){s.a.dispatch(Object(fe.q)({conversationId:e.conversationId,isTyping:!1}))}},cn=function(){var e=Object(r.a)(c.a.mark(function _callee(e){return c.a.wrap(function _callee$(t){for(;;)switch(t.prev=t.next){case 0:"CREATE"===e.body.type&&"MESSAGE"===e.body.object.type&&en(e);case 2:case"end":return t.stop()}},_callee)}));return function onUserChangeEvent(t){return e.apply(this,arguments)}}(),rn=function(){var e=Object(r.a)(c.a.mark(function _callee2(e){var t,n,a;return c.a.wrap(function _callee2$(c){for(;;)switch(c.prev=c.next){case 0:t=e.body,n=t.type,a=t.data,n===Vt&&s.a.dispatch(Object(je.c)({email:a.email}));case 2:case"end":return c.stop()}},_callee2)}));return function onUserTriggeredEvent(t){return e.apply(this,arguments)}}(),on=[tn],sn=[nn,an,{topic:"change",event:cn},{topic:"conversationPermaclose",event:function(){var e=Object(r.a)(c.a.mark(function _callee3(e){var t;return c.a.wrap(function _callee3$(n){for(;;)switch(n.prev=n.next){case 0:t=e.conversationId,s.a.dispatch(Object(fe.b)({conversationId:t}));case 2:case"end":return n.stop()}},_callee3)}));return function onUserPermacloseEvent(t){return e.apply(this,arguments)}}()},{topic:"event",event:rn}],un=[],ln=Object.freeze({CHAT:"chat",USER:"user",PRESENCE:"presence",VISITOR_PRESENCE:"visitor_presence"}),dn=Object.freeze({CHAT:"chat",USER:"user",ORG_PUBLIC:"live",LIVE:"live"}),bn=Object.freeze({CHAT:"chat",USER:"user",PRESENCE:"presence"}),fn=function(){var e=Object(r.a)(c.a.mark(function _callee2(e){var t,n,a,o,s;return c.a.wrap(function _callee2$(i){for(;;)switch(i.prev=i.next){case 0:return t=e.session_token,n=e.org_id,a=e.socketCluster,o=e.ip,s=new Promise(function(){var e=Object(r.a)(c.a.mark(function _callee(e,r){var s;return c.a.wrap(function _callee$(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,Dt({session_token:t,org_id:n,socketCluster:a,ip:o});case 2:if(!(s=c.sent)){c.next=7;break}return c.abrupt("return",e(s));case 7:return c.abrupt("return",r("could not connect"));case 8:case"end":return c.stop()}},_callee)}));return function(t,n){return e.apply(this,arguments)}}()),i.abrupt("return",s);case 3:case"end":return i.stop()}},_callee2)}));return function connectToSocket(t){return e.apply(this,arguments)}}(),pn=function(){var e=Object(r.a)(c.a.mark(function _callee3(e){var t,n,a,r,o,s;return c.a.wrap(function _callee3$(c){for(;;)switch(c.prev=c.next){case 0:return t=e.socket,n=e.socketAuth,a=e.channelEvents,r=e.channelName,o=e.orgId,c.prev=1,c.next=4,Lt({channelName:hn(r,n.user_id,o),socket:t,events:On(a)});case 4:return s=c.sent,c.abrupt("return",s);case 8:c.prev=8,c.t0=c.catch(1),Object(Ce.e)(new Error(c.t0));case 11:case"end":return c.stop()}},_callee3,null,[[1,8]])}));return function connectToChannel(t){return e.apply(this,arguments)}}(),hn=function _resolveChannelName(e,t,n){switch(e){case dn.USER:case dn.CHAT:return"".concat(e,":").concat(t);case dn.LIVE:return"".concat(e,":").concat(n);default:return""}},On=function _resolveChannelEvents(e){switch(e){case bn.CHAT:return on;case bn.USER:return sn;case bn.PRESENCE:return un;default:return[]}},vn=5e3,gn=function(){function SocketManager(){Object(xe.a)(this,SocketManager),this._fireChannelConnectedEvent=function(e,t,n){s.a.dispatch(Object(je.f)(Object(d.a)({key:e,cluster:t},n)))}}return Object(Ae.a)(SocketManager,[{key:"_fireSocketConnectedEvent",value:function _fireSocketConnectedEvent(e){s.a.dispatch(Object(je.r)({cluster:e}))}}]),SocketManager}();function chat_createSuper2(e){return function(){var t,n=Object(xt.a)(e);if(function isNativeReflectConstruct(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var a=Object(xt.a)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return Object(St.a)(this,t)}}var jn=new(function(e){Object(It.a)(ChatSocketManager,e);var t=chat_createSuper2(ChatSocketManager);function ChatSocketManager(){var e;return Object(xe.a)(this,ChatSocketManager),(e=t.call(this))._heartbeatInterval=void 0,e._socket=void 0,e._channel=void 0,e._sendPresencePing=Object(r.a)(c.a.mark(function _callee(){var t,n;return c.a.wrap(function _callee$(a){for(;;)switch(a.prev=a.next){case 0:if(e._channel){a.next=2;break}return a.abrupt("return");case 2:return a.next=4,Mt();case 4:t=a.sent,n=t.page,e._channel.channel.push("presence:send_update",{page:n});case 7:case"end":return a.stop()}},_callee)})),e.throttledPresencePing=Object(Nt.throttle)(vn,!1,e._sendPresencePing),e._socket=null,e._channel=null,e._heartbeatInterval=null,e}return Object(Ae.a)(ChatSocketManager,[{key:"connect",value:function(){var e=Object(r.a)(c.a.mark(function _callee2(e){var t,n,a,r=this;return c.a.wrap(function _callee2$(c){for(;;)switch(c.prev=c.next){case 0:return t=e.accessToken,n=e.orgId,dt(n),c.next=4,Object(yt.a)({fn:bt,socketCluster:ln.CHAT,token:t});case 4:return a=c.sent,c.next=7,fn({ip:a.remote_ip,org_id:n,session_token:a.session_token,socketCluster:ln.CHAT});case 7:return this._socket=c.sent,this._fireSocketConnectedEvent(ln.CHAT),c.next=11,pn({socket:this._socket,channelEvents:bn.USER,channelName:dn.USER,orgId:n,socketAuth:a});case 11:this._channel=c.sent,this._fireChannelConnectedEvent("user",ln.CHAT,this._channel),this._channel&&(this._sendPresencePing(),this._channel.channel.on("presence:request_update",function(){r.throttledPresencePing()}));case 14:case"end":return c.stop()}},_callee2,this)}));return function connect(t){return e.apply(this,arguments)}}()}]),ChatSocketManager}(gn)),mn=n("4+fu");function user_createSuper2(e){return function(){var t,n=Object(xt.a)(e);if(function isNativeReflectConstruct(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var a=Object(xt.a)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return Object(St.a)(this,t)}}new(function(e){Object(It.a)(UserSocketManager,e);var t=user_createSuper2(UserSocketManager);function UserSocketManager(){var e;return Object(xe.a)(this,UserSocketManager),(e=t.call(this))._heartbeatInterval=void 0,e._socket=void 0,e._channel=void 0,e.sendMessage=function(t){e._pushMessageToChannel("request:sendMessage",t)},e._pushMessageToChannel=function(t,n){Object(k.a)(!1,["_channel","channel"],Object(mn.a)(e))&&e._channel.channel.push(t,n)},e._socket=null,e._channel=null,e._heartbeatInterval=null,e}return Object(Ae.a)(UserSocketManager,[{key:"connect",value:function(){var e=Object(r.a)(c.a.mark(function _callee(e){var t,n,a,r;return c.a.wrap(function _callee$(c){for(;;)switch(c.prev=c.next){case 0:return t=e.orgId,n=e.accessToken,ut(),c.next=4,ft({access_token:n});case 4:return a=c.sent,r=a.data,c.next=8,fn(Object(d.a)(Object(d.a)({},r),{},{socketCluster:ln.USER,orgId:t,ip:r.remote_ip}));case 8:return this._socket=c.sent,this._fireSocketConnectedEvent(ln.USER),c.next=12,pn({socket:this._socket,channelEvents:bn.CHAT,socketAuth:r,channelName:dn.CHAT,orgId:t});case 12:this._channel=c.sent,this._fireChannelConnectedEvent("chat",ln.USER,this._channel),this._pushMessageToChannel("data:conversations");case 15:case"end":return c.stop()}},_callee,this)}));return function connect(t){return e.apply(this,arguments)}}()}]),UserSocketManager}(gn));function visitorPresence_createSuper2(e){return function(){var t,n=Object(xt.a)(e);if(function isNativeReflectConstruct(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var a=Object(xt.a)(this).constructor;t=Reflect.construct(n,arguments,a)}else t=n.apply(this,arguments);return Object(St.a)(this,t)}}var _n=new(function(e){Object(It.a)(VisitorPresenceSocketManager,e);var t=visitorPresence_createSuper2(VisitorPresenceSocketManager);function VisitorPresenceSocketManager(){var e;return Object(xe.a)(this,VisitorPresenceSocketManager),(e=t.call(this))._heartbeatInterval=void 0,e._socket=void 0,e._channel=void 0,e._socket=null,e._channel=null,e._heartbeatInterval=null,e}return Object(Ae.a)(VisitorPresenceSocketManager,[{key:"connect",value:function(){var e=Object(r.a)(c.a.mark(function _callee(e){var t,n,a;return c.a.wrap(function _callee$(c){for(;;)switch(c.prev=c.next){case 0:return t=e.orgId,n=e.accessToken,lt(),c.next=4,Object(yt.a)({fn:pt,socketCluster:ln.VISITOR_PRESENCE,token:n});case 4:return a=c.sent,c.next=7,fn({ip:a.remote_ip,org_id:t,session_token:a.session_token,socketCluster:ln.VISITOR_PRESENCE});case 7:return this._socket=c.sent,this._fireSocketConnectedEvent(ln.VISITOR_PRESENCE),c.next=11,pn({socket:this._socket,channelEvents:bn.PRESENCE,channelName:dn.LIVE,orgId:t,socketAuth:a});case 11:this._channel=c.sent,this._fireChannelConnectedEvent("user",ln.VISITOR_PRESENCE,this._channel),this._channel&&(this._updatePresence(),this.startPresenceUpdateHeartbeat());case 14:case"end":return c.stop()}},_callee,this)}));return function connect(t){return e.apply(this,arguments)}}()},{key:"startPresenceUpdateHeartbeat",value:function startPresenceUpdateHeartbeat(){this._heartbeatInterval=window.setInterval(this._updatePresence.bind(this),6e4)}},{key:"_updatePresence",value:function(){var e=Object(r.a)(c.a.mark(function _callee2(){var e;return c.a.wrap(function _callee2$(t){for(;;)switch(t.prev=t.next){case 0:if(this._channel){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,Mt();case 4:e=t.sent,this._channel.channel.push("heartbeat",e);case 6:case"end":return t.stop()}},_callee2,this)}));return function _updatePresence(){return e.apply(this,arguments)}}()},{key:"stopPresenceUpdateHeartbeat",value:function stopPresenceUpdateHeartbeat(){window.clearInterval(this._heartbeatInterval)}}]),VisitorPresenceSocketManager}(gn)),kn=n("OA1u"),wn=n("H/qh"),En=n("TbSn"),Cn=n("SWQ0"),yn=n("A5mO"),In=n("wNJw"),Sn=n("VpmR"),xn={isFromConversationalLandingPage:!1},An=function(){var e=Object(r.a)(c.a.mark(function _callee(e){var t,n,a,r,o,i;return c.a.wrap(function _callee$(c){for(;;)switch(c.prev=c.next){case 0:if(t=Object(k.a)({},["embed","configuration"],s.a.getState()),n=t.interactionSlugMap,a=void 0===n?{}:n,r=t.interactionTestingSlugMap,o=void 0===r?{}:r,i=e?e.substring(1):null){c.next=4;break}return c.abrupt("return",!1);case 4:if(!o[i]){c.next=8;break}return c.next=7,Rn(e,o[i],Object(d.a)(Object(d.a)({},xn),{},{isTestingConversation:!0}));case 7:return c.abrupt("return",!0);case 8:if(!a[i]){c.next=12;break}return c.next=11,Rn(e,a[i],xn);case 11:return c.abrupt("return",!0);case 12:return c.abrupt("return",!1);case 13:case"end":return c.stop()}},_callee)}));return function fireByDriftlink(t){return e.apply(this,arguments)}}(),Rn=function(){var e=Object(r.a)(c.a.mark(function _callee2(e,t,n){var a;return c.a.wrap(function _callee2$(c){for(;;)switch(c.prev=c.next){case 0:return a=Object(Oe.d)(),c.prev=1,s.a.dispatch(Object(fe.o)(e)),s.a.dispatch(Object(fe.p)()),c.next=6,Object(de.a)(t,Object(d.a)(Object(d.a)({},n),{},{locale:a}));case 6:c.next=11;break;case 8:c.prev=8,c.t0=c.catch(1),Object(Ce.k)({data:["Failed to activate drift link ".concat(e,":").concat(t),c.t0]});case 11:case"end":return c.stop()}},_callee2,null,[[1,8]])}));return function activateDriftLink(t,n,a){return e.apply(this,arguments)}}(),Mn=n("HSQL"),Tn=At.a.get,Pn=At.a.set;function Bootstrap(e){var t=e.embedId,n=e.params;return this.dispatch=s.a.dispatch,this.state=s.a.getState,this.embedId=t,this.params=n,this}Bootstrap.prototype.dataProtection=Object(r.a)(c.a.mark(function _callee(){var e,t,n,a,r,o,s,i,u,l,d,b,f;return c.a.wrap(function _callee$(c){for(;;)switch(c.prev=c.next){case 0:if(e=this.state(),t=e.embed,n=void 0===t?{}:t,a=e.session,o=(r=void 0===a?{}:a).gdpr,s=r.geo,i=(void 0===s?{}:s).country,u=null===n||void 0===n?void 0:n.configuration,l=u.dataProtection,d=function resolveNeedsConsent(e){return"ALL"===e||!("NONE"===e||!e)&&(!i||Object(wn.a)(i,mt[e]))},l){c.next=7;break}return c.abrupt("return",this.dispatch(Object(je.n)({needsConsent:!1,hasConsent:!0})));case 7:b=d(l.targeting),f=!b||o.hasConsent,this.dispatch(Object(je.n)({needsConsent:b,hasConsent:f}));case 10:case"end":return c.stop()}},_callee,this)})),Bootstrap.prototype.hydrateContext=Object(r.a)(c.a.mark(function _callee2(){var e;return c.a.wrap(function _callee2$(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(Ie.b)();case 2:return e=t.sent,this.dispatch(Object(je.h)(e)),t.abrupt("return",e);case 5:case"end":return t.stop()}},_callee2,this)})),Bootstrap.prototype.sendPageTrackEvent=function(e){Object(be.a)("Page",e.page)},Bootstrap.prototype.countVisit=Object(r.a)(c.a.mark(function _callee3(){var e,t,n,a,r,o,s;return c.a.wrap(function _callee3$(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,Object(u.a)({topic:"access-host-window",message:{key:"location"}});case 2:return e=c.sent,t=e.data,n=void 0===t?{}:t,c.next=7,Tn("visitCounts");case 7:a=c.sent,r=a.data,o=r||{},s=Object(wt.a)(o,function(e){e.total=(e.total||0)+1,e.daysSinceLastVisit=yn.a.now().since(e.lastVisit||yn.a.now()).diff.days,e.lastVisit=yn.a.now().epoch,e.firstVisit=e.firstVisit||yn.a.now().epoch,e[n.pathname]=(e[n.pathname]||0)+1}),Pn("visitCounts",s);case 12:case"end":return c.stop()}},_callee3)})),Bootstrap.prototype.fetchPreRequisiteData=Object(r.a)(c.a.mark(function _callee5(){var e,t,n,a,o,i,u;return c.a.wrap(function _callee5$(l){for(;;)switch(l.prev=l.next){case 0:return e={},this.dispatch(Object(je.q)({session:this.params.session})),l.prev=2,l.next=5,Ot(this.embedId);case 5:t=l.sent,n=t.data,a=t.responseTime,o=void 0===a?0:a,e=n,this.dispatch(he(e)),Object(Me.d)("Bootstrap.embed_fetch",o),l.next=17;break;case 14:l.prev=14,l.t0=l.catch(2),Object(Ce.e)(new kt.a("Embed Failed to load correctly - ".concat(l.t0.message)),l.t0);case 17:try{(i=Object(Se.f)(Object(k.a)(null,["configuration","theme","cookieDomains"],e)))&&s.a.dispatch(Object(je.i)({cookieDomain:i}))}catch(d){Object(Ce.e)(new kt.a("Failed to set custom cookie domain - ".concat(d.message)),d)}return u=function(){var t=Object(r.a)(c.a.mark(function _callee4(){var t;return c.a.wrap(function _callee4$(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,t=Object(k.a)("en",["configuration","locale"],e),n.next=4,Object(Sn.a)(t);case 4:n.next=9;break;case 6:n.prev=6,n.t0=n.catch(0),Object(Ce.k)({data:["i18n failed to load - ".concat(n.t0.message),n.t0],type:"warn"});case 9:case"end":return n.stop()}},_callee4,null,[[0,6]])}));return function setupI18n(){return t.apply(this,arguments)}}(),l.next=21,u();case 21:case"end":return l.stop()}},_callee5,this,[[2,14]])})),Bootstrap.prototype.handleBootstrap=Object(r.a)(c.a.mark(function _callee7(){var e,t,n,a,o,u,l,d,f,p,h,O,v,g,j,m,_,w,E,C,y,I,S=this;return c.a.wrap(function _callee7$(x){for(;;)switch(x.prev=x.next){case 0:return e=this.state(),t=e.embed,n=e.session,a=Object(k.a)("",["context","page","href"],n),o=n.campaignRefreshToken,u=t.orgId,l=null,d=null,f=null,x.prev=7,x.next=10,Object(ve.a)();case 10:return p=x.sent,x.next=13,Object(Mn.c)(Object(r.a)(c.a.mark(function _callee6(){return c.a.wrap(function _callee6$(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ln({orgId:u,embedId:S.embedId,sessionId:o,identifierMap:p,pageUrl:a});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},_callee6)})),"widget_core:bootstrap_api");case 13:h=x.sent,O=h.result,l=O.tokenResult,v=O.chatAuth||null,g=O.presenceAuth||null,d=O.widgetChatBootstrapResponse,this.dispatch(Object(je.o)(O.location)),v&&this.dispatch(Object(je.g)(v)),g&&this.dispatch(Object(je.p)(g)),d&&(Object(B.c)(d.campaignConversations),(j=Object.keys(d.campaignEnrollment)).length&&this.dispatch(Object(i.d)(j)),d.conversations.length&&this.dispatch(Object(fe.f)({conversations:d.conversations}))),f=O.evaluatedConditionsResults,x.next=29;break;case 26:x.prev=26,x.t0=x.catch(7),Object(Ce.e)(new kt.a("Failed Bootstrap API response - ".concat(x.t0.message)),x.t0);case 29:if(l){x.next=31;break}return x.abrupt("return");case 31:if(_=(m=l).accessToken,w=m.didConsentToRequestedConsentId,E=m.assignedAgentId,C=Object(b.a)(["didConsentToRequestedConsentId","accessToken","assignedAgentId"],l),this.dispatch(Object(je.j)({endUser:C,assignedAgentId:E})),this.dispatch(Object(je.e)({accessToken:_})),this.dispatch(Object(je.n)({hasConsent:w||!1})),this.handleSockets({orgId:u,accessToken:_}),d){x.next=39;break}return x.abrupt("return");case 39:return(y=Object(Et.b)(d.conversations,n))&&this.dispatch(Object(fe.n)({conversationId:y.conversation.id})),x.next=43,this.firePossibleDriftLink();case 43:if(!x.sent){x.next=46;break}return x.abrupt("return");case 46:I=Object(B.e)(d.campaignConversations),Object(_e.a)({evaluatedConditionsResults:f,onDidNotMatch:function onDidNotMatch(){Object(T.a)(d.conversations)||s.a.dispatch(Object(fe.h)({conversation:Object(En.a)(Object(P.a)(d.conversations))}))},unreadCampaignIds:I,skipCampaignTargeting:!!y});case 48:case"end":return x.stop()}},_callee7,this,[[7,26]])})),Bootstrap.prototype.handleSockets=function(){var e=Object(r.a)(c.a.mark(function _callee8(e){var t,n;return c.a.wrap(function _callee8$(a){for(;;)switch(a.prev=a.next){case 0:return t=e.orgId,n=e.accessToken,a.next=3,Object(Mn.c)(function(){return jn.connect({accessToken:n,orgId:t})},"widget_core.sockets:chat_connect");case 3:case"end":return a.stop()}},_callee8)}));return function(t){return e.apply(this,arguments)}}(),Bootstrap.prototype.firePossibleDriftLink=Object(r.a)(c.a.mark(function _callee9(){var e,t,n,a,r;return c.a.wrap(function _callee9$(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,Object(u.a)({topic:"get-host-window"});case 2:return e=c.sent,t=e.data,n=void 0===t?{}:t,a=Object(k.a)("",["location","hash"],n),c.next=8,An(a);case 8:return r=c.sent,c.abrupt("return",r);case 10:case"end":return c.stop()}},_callee9)})),Bootstrap.prototype.connectToPresence=function(){var e=this.state().session.auth.accessToken,t=this.state().embed.orgId;t&&e&&Object(Mn.c)(function(){return _n.connect({accessToken:e,orgId:t})},"widget_core.sockets:visitor_presence_connect")},Bootstrap.prototype.attachIntegrations=Object(r.a)(c.a.mark(function _callee10(){var e,t,n;return c.a.wrap(function _callee10$(a){for(;;)switch(a.prev=a.next){case 0:e=this.state().embed.configuration,t=(void 0===e?{}:e).integrations,n=void 0===t?{}:t,Object.keys(n).forEach(function(e){_t[e]&&Object(u.a)({topic:"handle-host-integration",message:{config:n[e],type:e}})});case 3:case"end":return a.stop()}},_callee10,this)})),Bootstrap.prototype.waitForUserJwt=function(){var e=Object(Ce.h)(function(){console.warn("Drift Widget is still waiting for user JWT!")},3e4);return new Promise(function(t){var n=s.a.subscribe(Object(r.a)(c.a.mark(function _callee11(){return c.a.wrap(function _callee11$(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(yt.d)();case 2:if(!a.sent){a.next=4;break}return a.abrupt("return");case 4:e(),n(),t();case 7:case"end":return a.stop()}},_callee11)})))})};var Nn=function(){var e=Object(r.a)(c.a.mark(function _callee13(e){var t,n,a,o,s,i,u,l,d;return c.a.wrap(function _callee13$(b){for(;;)switch(b.prev=b.next){case 0:return t=new Bootstrap(e),n=Object(k.a)(!1,["params","skipCampaigns"],e),a=Object(k.a)(!1,["params","forceShow"],e),o=Object(k.a)(null,["params","session","sessionId"],e),s=Object(k.a)(null,["params","session","instanceId"],e),t.dispatch(Object(kn.b)(n)),t.dispatch(Object(kn.a)(a)),i=function(){var e=Object(r.a)(c.a.mark(function _callee12(){return c.a.wrap(function _callee12$(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(Mn.c)(function(){return t.fetchPreRequisiteData()},"bootstrap: embed");case 3:return e.next=5,Object(yt.d)();case 5:if(!e.sent){e.next=8;break}return e.next=8,Object(Mn.c)(function(){return t.waitForUserJwt()},"bootstrap: waitForUserJwt");case 8:return e.next=10,Object(Mn.c)(function(){return t.handleBootstrap()},"bootstrap: bootstrap");case 10:return e.next=12,Object(Mn.c)(function(){return t.dataProtection()},"bootstrap: GDPR");case 12:Un(),t.dispatch(Object(F.c)({initComplete:!0})),e.next=20;break;case 16:e.prev=16,e.t0=e.catch(0),Object(Me.a)("bootstrap.failure"),Object(Ce.e)("Failed to bootstrap - ".concat(e.t0.message),e.t0);case 20:case"end":return e.stop()}},_callee12,null,[[0,16]])}));return function measuredInit(){return e.apply(this,arguments)}}(),b.prev=8,b.next=11,t.countVisit();case 11:return b.next=13,t.hydrateContext();case 13:return u=b.sent,o&&Dn(e.embedId,o,s,u),b.next=17,Object(Mn.c)(i,"bootstrap");case 17:l=b.sent,d=l.timing,Object(Me.d)("bootstrap",d),t.sendPageTrackEvent(u),t.attachIntegrations(),ye("has_presence_disabled")||t.connectToPresence(),Promise.resolve("bootstrap complete"),b.next=30;break;case 26:b.prev=26,b.t0=b.catch(8),Object(Ce.e)(new Error(b.t0)),Promise.reject("bootstrap failed");case 30:case"end":return b.stop()}},_callee13,null,[[8,26]])}));return function init(t){return e.apply(this,arguments)}}(),Un=function(){var e=Object(r.a)(c.a.mark(function _callee14(){var e;return c.a.wrap(function _callee14$(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,nt();case 2:e=t.sent,Object(In.a)(Cn.b.READY,e);case 4:case"end":return t.stop()}},_callee14)}));return function fireWidgetReadyEvent(){return e.apply(this,arguments)}}(),Dn=function fireWidgetInitEvent(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},c={eventName:"[V2] - init",embedId:e,sessionId:t,instanceId:n,context:{url:Object($t.a)(["page","url"],a),hostname:Object($t.a)(["page","hostname"],a),timezone:a.timezone,userAgent:a.userAgent}};s.a.dispatch(Object(Ct.a)(Date.now())),Object(vt.c)(c).catch(function(e){Object(Ce.k)({type:"warn",data:["Failed to send init event"]})})},Ln=function(){var e=Object(r.a)(c.a.mark(function _callee15(e){var t,n,a,r,o,s,i,u,l,b;return c.a.wrap(function _callee15$(c){for(;;)switch(c.prev=c.next){case 0:return t=e.orgId,n=e.embedId,a=e.sessionId,r=e.identifierMap,o=e.pageUrl,s={sessionId:a,pageUrl:o,hasHadConversations:!1,followingCampaignIds:[],excludedCampaignIds:[]},i=Object(d.a)(Object(d.a)({},r),{},{embed_id:n,targeting_context:s}),c.next=5,ht(t,i);case 5:return u=c.sent,l=u.data,b=u.responseTime,Object(Me.d)("enduser_bootstrap",b),c.abrupt("return",l);case 10:case"end":return c.stop()}},_callee15)}));return function callBootstrapApi(t){return e.apply(this,arguments)}}(),Bn=n("JBtm"),Vn=n.n(Bn),Fn=n("uiOv"),$n=n("EQxi");n("z8n0");s.a.name="controller";t.default=Object(Fn.a)(function WidgetControllerPage(e){var t=e.location,n=Object(w.useState)(!1),a=Object(o.a)(n,2),i=a[0],d=a[1],b=Object($n.f)(Vn.a.parse(t.search)),h=Object(Ce.o)();return Object(w.useEffect)(function(){if(i){var e=Object(Mn.b)("widget_core:widget_loaded");e&&(Object(Me.d)("loaded",e),Object(Me.a)("widget.v2.load",!1));var t=s.a.getState().embed,n=void 0===t?{}:t;return Object(oe.a)(n),void Object(oe.b)(n)}Object(p.a)({name:"controller",syncWith:"chat",store:s.a}),f(),l(),Object(u.c)({topic:"trigger-api-event",handler:rt}),Object(u.c)({topic:"get-ready-payload",handler:nt}),Object(u.c)({topic:"identity-provided-email",handler:function handler(e){var t=e.data,n=void 0===t?{}:t;s.a.dispatch(Object(je.k)(n.email))}}),Object(u.c)({topic:"hide-widget-on-ready",handler:function handler(e){e.data,s.a.dispatch(Object(kn.c)(!0))}}),Object(u.c)({topic:"show-widget-on-ready",handler:function handler(e){e.data,s.a.dispatch(Object(kn.a)(!0))}}),Object(u.c)({topic:"identity-provided-id",handler:function handler(e){var t=e.data,n=void 0===t?{}:t;s.a.dispatch(Object(je.l)(n.externalId))}}),Object(u.c)({topic:"identity-provided-jwt",handler:function handler(e){var t=e.data,n=void 0===t?{}:t;s.a.dispatch(Object(je.m)(n.userJwt))}}),Object(u.c)({topic:"host-hash-change",handler:function handler(e){var t=e.data;return An(t.hash)}}),Object(u.c)({topic:"init-ready",handler:function(){var e=Object(r.a)(c.a.mark(function _callee(){return c.a.wrap(function _callee$(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,e.t0=!i,!e.t0){e.next=5;break}return e.next=5,Nn({embedId:b.embedId,params:{skipCampaigns:b.skipCampaigns,forceShow:b.forceShow,session:{sessionId:b.sessionId,sessionStarted:b.sessionStarted,campaignRefreshToken:b.campaignRefreshToken,instanceId:h}}});case 5:d(!0),e.next=11;break;case 8:e.prev=8,e.t1=e.catch(0),console.warn(e.t1);case 11:case"end":return e.stop()}},_callee,null,[[0,8]])}));return function handler(){return e.apply(this,arguments)}}()}),Object(In.a)(Cn.b.API_READY)},[b.embedId,b.forceShow,b.skipCampaigns,i,b.sessionId,b.sessionStarted,b.campaignRefreshToken,h]),E.a.createElement(N.a,{store:s.a},i&&E.a.createElement(ue,null))})},LwEI:function(e,t,n){"use strict";var a=n("LVcX"),c=n("uDfI"),r=n("vTYT");t.a=function useWidgetAlignment(){return Object(c.c)(function(e){return Object(a.a)(r.a.RIGHT,["embed","configuration","theme","alignment"],e)})}},My8U:function(e,t,n){"use strict";var a=n("nfbA"),c=n("SWQ0"),r=n("wNJw"),o=n("7oto");t.a=function UseStoreSync(e){var t=e.store,n=e.syncWith,s=e.name;return Object(o.c)({topic:"CONDUCTOR:action-from-".concat(n),handler:function handler(e){t.dispatch(Object(a.a)(Object(a.a)({},e.data.action),{},{_foreignDispatch:!0}))}}),Object(r.a)(c.a["".concat(s.toUpperCase(),"_READY")]),t}},NJR1:function(e,t,n){},"ab+K":function(e,t,n){"use strict";var a=n("nJ3u"),c=n("O94r"),r=n.n(c),o=n("/UYI"),s=n("nQD+"),i=n("z24s"),u=n("lE29"),l=n("LwEI"),d=n("ERkP"),b=n.n(d);n("NJR1");t.a=function MessageCloseButton(e){var t=e.onClick,n=Object(l.a)(),c=Object(u.a)(),f=Object(d.useRef)(null),p=Object(i.a)(f);return b.a.createElement(b.a.Fragment,null,b.a.createElement("style",null,".drift-widget-message-close-button.keyboard-focused {\n          opacity: 1;\n        }\n        .drift-widget-message-close-button.keyboard-focused:before {\n          ".concat(Object(a.a)(c.activeColor,24),"\n        }\n        ")),b.a.createElement(s.a,{onClick:t,ref:f,className:r()("drift-widget-message-close-button","drift-widget-close-button--align-".concat(n),{"keyboard-focused":p}),"aria-label":"close"},b.a.createElement(o.a,{width:8,height:8})))}},nedb:function(e,t,n){"use strict";var a=n("LVcX"),c=n("uDfI"),r=function activeCampaignSelector(e){return Object(a.a)(null,["campaigns","activeCampaign"],e)};t.a=function useActiveCampaign(){return Object(c.c)(r)}},o3t1:function(e,t,n){"use strict";var a=n("s8DI"),c=n("ERkP"),r=n("0lfv"),o=n("6wvX");t.a=function useOnHover(){var e=Object(o.a)(),t=Object(c.useState)(!1),n=Object(a.a)(t,2),s=n[0],i=n[1];return Object(c.useMemo)(function(){return e?{}:{hoverProps:{onMouseOver:function onMouseOver(){return i(!0)},onMouseOut:function onMouseOut(){return i(!1)},onFocus:r.l,onBlur:r.l},isHovered:s}},[e,s])}},pUpc:function(e,t,n){},qixE:function(e,t,n){"use strict";n.d(t,"a",function(){return f}),n.d(t,"b",function(){return h});var a=n("mj2O"),c=n.n(a),r=n("7SM1"),o=n("OE2q"),s=n("QtlZ"),i=n("PCkZ"),u=n("DboL"),l=n("M7cN"),d=n("6lNa"),b=n("PjZB"),f=function(){var e=Object(r.a)(c.a.mark(function _callee(e){var t,n,a;return c.a.wrap(function _callee$(c){for(;;)switch(c.prev=c.next){case 0:if(e.email&&e.conversationId){c.next=2;break}return c.abrupt("return");case 2:return t={conversationId:e.conversationId,type:d.b.LEAD_CAPTURED,email:e.email,leadCapture:{email:e.email,integrations:Object(i.b)(),context:p()}},c.next=5,Object(o.h)(t);case 5:return n=c.sent,a=n.data,c.abrupt("return",a);case 8:case"end":return c.stop()}},_callee)}));return function createLeadCapturedConversationEvent(t){return e.apply(this,arguments)}}(),p=function hydrateConversationEventContext(){var e=s.a.getState().session,t=(void 0===e?{}:e).context||{},n=t.userAgent,a=t.locale,c=t.timezone,r=t.page;return{page:void 0===r?{}:r,locale:a,timezone:c,userAgent:n}},h=function getUnreadMostRecentConversation(e,t){var n=t.sessionStarted,a=parseInt(n),c=Object(u.a)(e).filter(function(e){return O(e,a)});return c.length?Object(l.a)(function(e){return e.lastMessage.createdAt},c)[0]:null},O=function isUnreadRecentConversation(e,t){return!!e.lastMessage&&null!==e.lastReadMessage&&e.lastMessage.viewerRecipientStatus!==b.f.READ&&e.conversation.type===d.c.CHAT&&e.lastMessage.authorType===b.b.USER&&e.lastMessage.createdAt>=1e3*t}},rAhV:function(e,t,n){"use strict";var a=n("OE2q"),c=n("K7i0"),r=n("bYXQ"),o=n("uDfI"),s=n("0lfv");t.a=function useMarkAsRead(){var e=Object(o.c)(function(e){return e.conversations}).unreadAgentMessages,t=void 0===e?{}:e,n=Object(o.b)();return{markAsRead:function markAsRead(e){var o=t[e]||[];if(o.length)try{Object(r.c)(e)||Object(a.g)(e,o),n(Object(c.l)({conversationId:e}))}catch(i){Object(s.e)(new Error(i))}}}}},tLIi:function(e,t,n){"use strict";var a=n("da4L"),c=n("LVcX"),r=n("i9gz"),o=n("TbSn"),s=n("uDfI");t.a=function useLastAgentMessage(){var e=Object(s.c)(function(e){return e.conversations}).activeConversation,t=Object(s.c)(function(t){return Object(c.a)(null,["conversations","conversations",e,"lastAgentMessage"],t)}),n=Object(s.c)(function(t){var n=Object(c.a)({},["conversations","messages",e],t);if(Object(r.a)(n))return{};var s=Object(a.n)(n).filter(function(e){return"USER"===Object(c.a)(null,["authorType"],e)});return s.length?Object(o.a)(s):void 0});return t||n||{}}},y0on:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var a=n("0lfv"),c=function getNewMessageAriaLabel(e,t){return Object(a.j)(t)?null:"Chat message".concat(e?" from "+e:"",': "').concat(t,'"')}},z8n0:function(e,t,n){}}]);